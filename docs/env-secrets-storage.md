# Environment secret storage guide

This document explains where runtime secrets and environment variables must live so that sensitive values do not leak into Git history. It complements [`REQUIRED_SECRETS.md`](../REQUIRED_SECRETS.md) by adding storage guidance for each service.

## Git ignore boundaries
- `.gitignore` excludes `.env`, `.env.production`, and related backups across the repository. This keeps ad-hoc environment files out of commits when cloning or deploying locally.【F:.gitignore†L1-L12】
- `config/local-secrets.json` is also ignored because `scripts/ensureLocalSecrets.js` writes development-only credentials there.【F:.gitignore†L1-L12】【F:REQUIRED_SECRETS.md†L6-L6】

## Where to store secrets
| Scope | Keys | Storage location |
| --- | --- | --- |
| **AI Service** | `AI_INTERNAL_TOKEN`, `GROQ_API_KEY`, `FIREBASE_SERVICE_ACCOUNT_KEY`, `FIREBASE_PROJECT_ID`, `ALLOWED_BACKEND_IPS` | GitHub repository secrets for production/CI. Local development pulls from `config/local-secrets.json` generated by `scripts/ensureLocalSecrets.js`.【F:REQUIRED_SECRETS.md†L8-L22】 |
| **Backend** | `AI_INTERNAL_TOKEN`, `SESSION_SECRET`, `FIREBASE_SERVICE_ACCOUNT_KEY`, `FIREBASE_PROJECT_ID`, `AI_SERVICE_URL`, `SECRETS_ENC_KEY`, `ADMIN_SETUP_TOKEN` | GitHub repository secrets (prod/CI) and `config/local-secrets.json` for local development. `.env`/`.env.production` files remain untracked placeholders only.【F:REQUIRED_SECRETS.md†L24-L42】 |
| **Frontend** | `VITE_FIREBASE_*`, `VITE_ADMIN_SETUP_TOKEN`, `VITE_ORIGIN`, `VITE_RP_ID`, `VITE_ENABLE_PUBLIC_CHAT`, `VITE_ASSISTANT_MODE`, `VITE_GITHUB_ENABLED`, `VITE_BACKEND_URL`, `VITE_API_BASE`, `VITE_GATEWAY_URL`, `VITE_REMOTE_SITE_BASE`, `AI_SERVICE_URL` | GitHub repository secrets via Actions environment variables, or `.env` copies kept outside version control for manual builds.【F:REQUIRED_SECRETS.md†L44-L75】 |
| **GitHub integration** | `GITHUB_TOKEN`, `GITHUB_REPO_OWNER`, `GITHUB_REPO_NAME`, `GITHUB_WEBHOOK_SECRET`, optional overrides (`GITHUB_API_URL`, `GITHUB_OWNER`, `GITHUB_REPO`) | GitHub repository secrets and/or environment-specific configuration inside GitHub Actions environments. Never commit to `.env` in Git.【F:REQUIRED_SECRETS.md†L91-L110】 |

> ℹ️ **Production note:** `AI_INTERNAL_TOKEN` and `SESSION_SECRET` must be 256-bit random strings and shared between backend ↔ AI Service exactly once per rotation.【F:REQUIRED_SECRETS.md†L77-L83】

## Operational hygiene
1. Run `node check-secrets.js` locally or in CI to confirm every required key is present before deployment.【F:REQUIRED_SECRETS.md†L119-L124】
2. Run `node check-github-env.js` (or `node scripts/github-verification.js` for deeper checks) to validate GitHub integration variables and API access.【F:REQUIRED_SECRETS.md†L91-L110】【F:REQUIRED_SECRETS.md†L126-L130】
3. Keep `.env`, `.env.production`, and other ad-hoc files restricted to local machines. Use `.env.example` as the only tracked template when onboarding new environments.【F:.gitignore†L1-L12】

Following this flow ensures secrets are centralised in GitHub while development helpers stay out of version control.
