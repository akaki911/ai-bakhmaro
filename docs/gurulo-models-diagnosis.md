# Gurulo მოდელების ჩატვირთვის შეფერხების დიაგნოზი

## სიმპტომი
- Gurulo-ს ჩატის ინტერფეისში მოდელების ჩამონათვალი მუდმივად აჩვენებს ტექსტს "Loading models..." და არჩევის შესაძლებლობა არ ჩნდება.

## დეტალური მიზეზი
- ფრონტენდ კომპონენტი `AiDeveloperChatPanel.tsx` მოდელების ჩამონათვალს ავსებს `availableModels` მასივიდან. თუ მასივი ცარიელია, ჩამონათვალი აჩვენებს "Loading models..." შეტყობინებას და მომხმარებელი ვერ ირჩევს მოდელს. დოკში მითითებულია შესაბამისი JSX ბლოკი, რომელიც ამ ქცევას განსაზღვრავს.
- `availableModels` ივსება `/api/ai/models` ენდპოინტზე მოთხოვნის წარმატებით შესრულების შემთხვევაში. მოთხოვნა სრულდება `safeAiFetch` ჰელსერის საშუალებით, რომელიც 401 პასუხის მიღებისას ავტორიზაციის შეცდომას აფიქსირებს და შეცდომას აგდებს.
- ბექენდზე `/api/ai/models` ენდპოინტი დაცულია `authorizeAiMetadataRequest` middleware-ით. middleware უშვებს მხოლოდ იმ მოთხოვნებს, სადაც სესიის მომხმარებლის როლი `SUPER_ADMIN` ან `ADMIN` არის, ან მითითებულია ავტორიზებული პირადი ნომერი, ან გადმოწოდებულია ადმინისტრატორის/სერვისის ტოკენები. სხვა ყველა შემთხვევაში middleware 401 სტატუსს უბრუნებს და მოთხოვნას აჩერებს.
- შედეგად, არასაკმარისი უფლებების მქონე მომხმარებლები `/api/ai/models` ენდპოინტიდან 401 პასუხს იღებენ, `availableModels` ცარიელი რჩება და UI უწყვეტად აჩვენებს "Loading models..." შეტყობინებას.

## დასკვნა
პრობლემის ძირითადი მიზეზი არის ავტორიზაციის ზღუდე `/api/ai/models` ენდპოინტზე. სანამ მომხმარებელი არ დაადასტურებს თავს როგორც `SUPER_ADMIN`/`ADMIN`, ან არ მიაწვდის ერთ-ერთ ნებადართულ ტოკენს/პირად ნომერს, მოდელების სია ვერ იტვირთება და UI რჩება "Loading models..." მდგომარეობაში.
